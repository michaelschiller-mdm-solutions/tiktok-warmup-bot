# Task 12-20: Content Registry Integration and Architecture Consolidation

## Description

Consolidate all content sprint functionality (Campaign Pools, Highlight Groups, Sprint Management) into the Content Registry system as integrated tabs, aligning the implementation with the PRD's specified architecture where everything operates as a unified content management system.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2025-06-19 15:30:00 | Created | N/A | Proposed | Task created to consolidate content sprint architecture | Assistant |
| 2025-06-19 15:45:00 | Status Update | Proposed | InProgress | Implementation started | Assistant |
| 2025-06-19 16:00:00 | Status Update | InProgress | Review | Phase 1-4 complete, testing needed | Assistant |
| 2025-06-19 16:20:00 | Status Update | Review | Done | All TypeScript errors resolved, architecture consolidation complete | Assistant |

## Requirements

### Primary Objective
Transform the current separate page architecture into a unified Content Registry system with the following tab structure:

1. **Content Tab** (existing) - Raw content items (images/videos)
2. **Bundles Tab** (existing) - Content bundles  
3. **Texts Tab** (existing) - Text content templates
4. **Campaign Pools Tab** (new) - All content sprints with `is_highlight_group = false`
5. **Highlight Groups Tab** (new) - All content sprints with `is_highlight_group = true`
6. **Timeline Tab** (existing as separate page) - Gantt chart visualization

### Technical Requirements

#### Database Schema Alignment
- **Content Sprints Table**: Already correctly implements `is_highlight_group` boolean flag
- **Campaign Pools**: Should reference sprints with `is_highlight_group = false`  
- **Highlight Groups**: Should be sprints with `is_highlight_group = true`
- **Content Categories**: `['story', 'post', 'highlight']` within sprint content items

#### Component Integration
- **Migrate CampaignPoolsPage** → CampaignPoolsTab component within Content Registry
- **Migrate HighlightGroupsPage** → HighlightGroupsTab component within Content Registry  
- **Integrate SprintManagement** functionality into Campaign Pools tab
- **Move Gantt Chart** → Timeline tab within Content Registry
- **Remove separate routes** for `/pools`, `/highlights`, `/sprints`

#### User Experience Requirements
- **Unified Navigation**: Single "Content Registry" navigation item with internal tabs
- **Cross-Tab Integration**: Easy movement between content types and sprint management
- **Upload Flow Enhancement**: Ask "Is this for highlights, posts, story? Should stories convert to highlights? Timing? Blocking rules?"
- **Consistent UI Patterns**: All tabs follow same design language and interaction patterns

### Functional Specifications

#### Content Registry Tab Structure
```
Content Registry
├── Content Tab (Raw Images/Videos)
├── Bundles Tab (Content Bundles)  
├── Texts Tab (Text Templates)
├── Campaign Pools Tab (Content Sprints: is_highlight_group = false)
│   ├── Sprint Creation Wizard
│   ├── Pool Creation from Compatible Sprints
│   ├── Assignment Management
│   └── Content Upload with Categories
├── Highlight Groups Tab (Content Sprints: is_highlight_group = true)
│   ├── Group Creation Wizard
│   ├── Maintenance Scheduling
│   ├── Position Management
│   └── Seasonal Content Batches
└── Timeline Tab (Gantt Chart)
    ├── Account Sprint Visualization
    ├── Conflict Detection Display
    └── Real-time Assignment Tracking
```

#### Enhanced Upload Flow
When uploading content to Campaign Pools or Highlight Groups:
1. **Content Type Selection**: "Is this for highlights, posts, story?"
2. **Story Conversion**: "Should stories convert to highlights automatically?"
3. **Timing Configuration**: "Posting frequency and realistic delays?"
4. **Blocking Rules**: "What conflicts should this prevent?"

#### Data Model Unification
- **Campaign Pool** = Content Sprint with `is_highlight_group = false`
- **Highlight Group** = Content Sprint with `is_highlight_group = true`
- **Content Categories** = `['story', 'post', 'highlight']` per content item
- **Sprint Types** = `['vacation', 'university', 'home', 'work', 'fitness']`

## Implementation Plan

### Phase 1: Content Registry Structure (Day 1)
1. **Extend Content Registry Tabs**:
   - Add `campaignPools` and `highlightGroups` tabs to existing tab state
   - Update tab navigation UI to include new tabs
   - Add Timeline tab integration

2. **Component Migration**:
   - Extract core functionality from `CampaignPoolsPage` → `CampaignPoolsTab`
   - Extract core functionality from `HighlightGroupsPage` → `HighlightGroupsTab`  
   - Create `TimelineTab` wrapper for Gantt chart functionality

### Phase 2: Route Cleanup and Integration (Day 1)
3. **Remove Separate Routes**:
   - Remove `/pools`, `/highlights`, `/sprints` routes from App.tsx
   - Remove navigation items from Layout.tsx sidebar
   - Update any internal links to use Content Registry tabs

4. **Navigation Updates**:
   - Single "Content Registry" navigation item  
   - Internal tab navigation within Content Registry
   - Breadcrumb updates for deep navigation

### Phase 3: Cross-Tab Integration (Day 2)
5. **Enhanced Upload Flow**:
   - Modify upload modals to detect target tab context
   - Add content type selection for Campaign Pools/Highlight Groups
   - Implement story → highlight conversion options
   - Add blocking rules configuration during upload

6. **Data Flow Unification**:
   - Ensure Campaign Pools tab only shows sprints with `is_highlight_group = false`
   - Ensure Highlight Groups tab only shows sprints with `is_highlight_group = true`
   - Shared creation wizards with appropriate filtering

### Phase 4: UI Consistency and Polish (Day 2)
7. **Design Harmonization**:
   - Consistent design patterns across all tabs
   - Unified loading states and error handling
   - Shared component library usage

8. **User Experience Enhancement**:
   - Context-aware actions based on current tab
   - Quick cross-tab navigation for related items
   - Unified search and filtering across content types

## Verification

### Integration Testing
- [ ] Content Registry loads with all 6 tabs functional
- [ ] Campaign Pools tab only displays sprints with `is_highlight_group = false` 
- [ ] Highlight Groups tab only displays sprints with `is_highlight_group = true`
- [ ] Timeline tab properly integrates Gantt chart functionality
- [ ] All separate page routes removed and return 404
- [ ] Navigation only shows "Content Registry" item

### Functional Testing  
- [ ] Content upload flow prompts for type selection (highlights/posts/story)
- [ ] Story → highlight conversion options work correctly
- [ ] Blocking rules configuration during upload functions
- [ ] Cross-tab navigation and context switching works seamlessly
- [ ] All existing functionality preserved during migration

### Data Integrity Testing
- [ ] Database queries correctly filter by `is_highlight_group` flag
- [ ] Content categories properly handled across sprint types
- [ ] Sprint assignment system works with unified data model
- [ ] No data loss during architecture transition

## Files Modified

### ✅ Successfully Implemented Files

#### Frontend Core Components
- ✅ **`src/components/CentralContentRegistry.tsx`** - Extended with 6 tabs (content, bundles, texts, campaignPools, highlightGroups, timeline)
  - Added new tab types to TypeScript interface
  - Added new tab navigation with overflow handling for mobile
  - Extended statistics cards to show Campaign Pools, Highlight Groups, and Active Sprints
  - Added conditional rendering for new tab components
  - Enhanced upload flow integration for new tabs

#### Tab Components (Already Existed)
- ✅ **`src/components/CampaignPools/CampaignPoolsTab.tsx`** - Tab component with filtering for `is_highlight_group = false`
- ✅ **`src/components/HighlightGroups/HighlightGroupsTab.tsx`** - Tab component with highlight group functionality  
- ✅ **`src/components/Timeline/TimelineTab.tsx`** - Gantt chart integration as tab component

#### Route Cleanup
- ✅ **`src/App.tsx`** - Removed separate routes for `/sprints`, `/pools`, `/highlights`, `/timeline`
- ✅ **`src/components/Layout.tsx`** - Removed separate navigation items, kept only "Content Registry"

### Implementation Summary

**Before (Separate Pages)**:
```
/content     → Content Registry (3 tabs)
/sprints     → Sprint Management  
/pools       → Campaign Pools Page
/highlights  → Highlight Groups Page
/timeline    → Gantt Page
```

**After (Unified Content Registry)**:
```
/content     → Content Registry (6 tabs):
  ├── Content Library Tab
  ├── Content Bundles Tab  
  ├── Text Library Tab
  ├── Campaign Pools Tab (is_highlight_group = false)
  ├── Highlight Groups Tab (is_highlight_group = true)
  └── Timeline Tab (Gantt chart integration)
```

### Architecture Compliance Achieved
- ✅ **Single Navigation Point**: Only "Content Registry" navigation item
- ✅ **Unified Interface**: All content sprint functionality in tabs
- ✅ **Data Model Alignment**: Proper filtering by `is_highlight_group` flag
- ✅ **Upload Flow Integration**: Context-aware upload buttons for new tabs
- ✅ **Clean Architecture**: No duplicate routes or navigation items
- ✅ **Responsive Design**: Tab navigation with overflow handling

## Dependencies

### Technical Dependencies
- **Existing Content Registry**: Base component structure and tab management
- **Backend APIs**: All sprint, highlight group, and campaign pool endpoints already implemented  
- **Frontend Components**: CampaignPoolsPage, HighlightGroupsPage, GanttPage components for migration

### Data Dependencies  
- **Database Schema**: Already correctly implements `is_highlight_group` flag in content_sprints table
- **Content Data**: Existing content sprints, highlight groups, and campaign pools
- **Account Assignments**: Sprint assignments and content queue data

## Acceptance Criteria

### Architecture Compliance
✅ **Unified Interface**: All content sprint functionality accessed through Content Registry tabs, not separate pages

✅ **Data Model Alignment**: Campaign Pools and Highlight Groups properly filtered by `is_highlight_group` flag

✅ **Upload Flow Enhancement**: Content upload prompts for type selection and conversion options according to PRD specifications

### User Experience
✅ **Single Navigation Point**: "Content Registry" is the only navigation item for all content management

✅ **Seamless Tab Switching**: Users can easily move between content types without losing context

✅ **Enhanced Upload Experience**: Upload flow asks appropriate questions about content type, timing, and blocking rules

### Technical Excellence
✅ **Clean Architecture**: No duplicate functionality between tabs and removed page components

✅ **Performance**: Tab switching is instant with proper state management

✅ **Data Integrity**: All existing data and functionality preserved during architectural consolidation

---

**Link back to task list**: [Tasks for PBI 12](./tasks.md#user-content-12-20) 